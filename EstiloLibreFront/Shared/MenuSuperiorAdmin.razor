@using Microsoft.AspNetCore.Components.Authorization
<link href="css/Shared/MenuSuperiorAdmin.css" rel="stylesheet" />

<MudAppBar Elevation="0" Dense="false" Color="Color.Primary" Class="appbar-admin">
    <!-- Botón hamburguesa para móviles -->
    <MudIconButton Icon="@Icons.Material.Filled.Menu"
                   Color="Color.Tertiary"
                   Edge="Edge.Start"
                   OnClick="@this.AlternarDrawer"
                   Class="d-flex d-md-none" />
    
    <MudText Typo="Typo.h6" Class="ml-3">@Traductor["lblPanelAdministracion"]</MudText>
    
    <MudSpacer />
    
    <!-- Información del usuario admin -->
    <MudChip T="string" 
             Icon="@Icons.Material.Filled.AdminPanelSettings"
             Color="Color.Tertiary"
             Size="Size.Medium"
             Variant="Variant.Outlined"
             Class="mr-2">
        @this.ServicioDatosContexto.GetLoginUsuario()
    </MudChip>
    
    <!-- Menú de opciones -->
    <MudMenu Dense
             Variant="Variant.Text"
             Size="Size.Medium"
             Color="Color.Tertiary"
             Icon="@Icons.Material.Filled.MoreVert">
        <MudMenuItem ForceLoad
                     Icon="@Icons.Material.TwoTone.Logout"
                     IconColor="Color.Error"
                     OnClick="@this.LogOut">
            @Traductor["btnCerrarSesion"]
        </MudMenuItem>
    </MudMenu>
</MudAppBar>

@code {
    #region ***** DEPENDENCIAS *****
    [Inject]
    public required IStringLocalizer<TrShared> Traductor { get; set; }
    
    [Inject]
    public required ServicioLogIn ServicioLogIn { get; set; }
    
    [Inject]
    public required ServicioDatosContexto ServicioDatosContexto { get; set; }
    
    [Inject]
    public required ServicioNavegacion ServicioNavegacion { get; set; }
    #endregion

    #region ***** PARÁMETROS *****
    [CascadingParameter]
    public LayoutAdministracion? Layout { get; set; }
    #endregion

    #region ***** PROPIEDADES PRIVADAS *****
    #endregion

    #region ***** MÉTODOS PÚBLICOS *****
    #endregion

    #region ***** MÉTODOS PRIVADOS *****
    private void LogOut()
    {
        this.ServicioLogIn.LogOut();
        this.ServicioNavegacion.NavegarA(URLsPantallas.Login, true);
    }
    
    private void AlternarDrawer()
    {
        this.Layout?.MenuLateral?.AlternarDrawer();
    }
    #endregion
}